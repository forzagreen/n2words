#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Run commitlint with better error messages
echo ""
echo "üîç Checking commit message format..."
echo ""

if ! npx --no -- commitlint --edit "$1" 2>&1; then
  EXIT_CODE=$?
  echo ""
  echo "‚ùå Commit message validation failed!"
  echo ""
  echo "üìã Required format: <type>(<scope>): <subject>"
  echo ""
  echo "Valid types:"
  echo "  ‚Ä¢ feat     - New feature"
  echo "  ‚Ä¢ fix      - Bug fix"
  echo "  ‚Ä¢ docs     - Documentation changes"
  echo "  ‚Ä¢ style    - Code style changes (formatting, semicolons, etc.)"
  echo "  ‚Ä¢ refactor - Code refactoring"
  echo "  ‚Ä¢ perf     - Performance improvements"
  echo "  ‚Ä¢ test     - Test changes"
  echo "  ‚Ä¢ build    - Build system changes"
  echo "  ‚Ä¢ ci       - CI/CD changes"
  echo "  ‚Ä¢ chore    - Other changes (dependencies, etc.)"
  echo "  ‚Ä¢ revert   - Revert previous commit"
  echo "  ‚Ä¢ lang     - Language implementation changes"
  echo ""
  echo "Valid scopes (optional):"
  echo "  ‚Ä¢ deps, ci, docs, test, build, lang, core, types"
  echo ""
  echo "Examples:"
  echo "  ‚úì feat: add new language support"
  echo "  ‚úì fix(core): handle edge case in conversion"
  echo "  ‚úì docs: update README"
  echo "  ‚úì test(lang): add tests for Spanish converter"
  echo ""
  echo "Your commit message:"
  cat "$1"
  echo ""
  exit $EXIT_CODE
fi

echo "‚úÖ Commit message format is valid!"
echo ""
