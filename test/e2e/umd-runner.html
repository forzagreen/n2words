<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>n2words UMD Bundle Test</title>
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        background: #f5f5f5;
        padding: 20px;
        line-height: 1.6;
      }
      .container {
        max-width: 900px;
        margin: 0 auto;
        background: white;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        padding: 30px;
      }
      h1 {
        color: #333;
        margin-bottom: 10px;
        font-size: 28px;
      }
      .subtitle {
        color: #666;
        margin-bottom: 30px;
        font-size: 14px;
      }
      #status {
        font-size: 20px;
        font-weight: bold;
        padding: 15px 20px;
        border-radius: 6px;
        margin-bottom: 20px;
      }
      #status.running {
        background: #fff3cd;
        color: #856404;
        border: 1px solid #ffeaa7;
      }
      #status.pass {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }
      #status.fail {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }
      #results {
        background: #fafafa;
        border: 1px solid #e0e0e0;
        border-radius: 6px;
        padding: 20px;
        font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
        font-size: 13px;
        line-height: 1.8;
      }
      .test-case {
        padding: 6px 0;
        display: flex;
        align-items: flex-start;
      }
      .test-icon {
        margin-right: 10px;
        flex-shrink: 0;
      }
      .test-description {
        flex: 1;
        color: #555;
      }
      .test-details {
        color: #888;
        font-size: 11px;
        margin-left: 26px;
        margin-top: 2px;
      }
      .pass {
        color: #28a745;
      }
      .fail {
        color: #dc3545;
      }
      .summary {
        margin-top: 20px;
        padding-top: 20px;
        border-top: 2px solid #e0e0e0;
      }
      .summary-stats {
        font-size: 16px;
        color: #555;
      }
      .summary-stats strong {
        color: #333;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <h1>n2words UMD Bundle Test</h1>
      <div class="subtitle">
        Tests individual UMD language bundles (dist/*.umd.js) loading via script tags.
        Multiple bundles extend the same n2words global.
      </div>

      <div id="status" class="running">⏳ Running tests...</div>
      <div id="results"></div>
    </div>
  </body>

  <!-- Load individual language UMD bundles - they extend window.n2words -->
  <script src="../../dist/en-US.umd.js"></script>
  <script src="../../dist/fr.umd.js"></script>
  <script src="../../dist/zh-Hans.umd.js"></script>
  <script>
    window.onload = () => {
      const results = document.getElementById('results')
      const status = document.getElementById('status')

      let passCount = 0
      let failCount = 0
      const tests = []

      function test(description, testFn) {
        let passed = false
        let error = null

        try {
          passed = testFn()
        } catch (e) {
          error = e.message
        }

        tests.push({ description, passed, error })

        if (passed) {
          passCount++
        } else {
          failCount++
        }
      }

      // ========================================================================
      // UMD Individual Bundle Loading Tests
      // ========================================================================

      test('n2words global is defined', () => {
        return typeof window.n2words === 'object' && window.n2words !== null
      })

      test('American English converter (enUS) is loaded', () => {
        return typeof window.n2words.enUS === 'function'
      })

      test('French converter (fr) is loaded', () => {
        return typeof window.n2words.fr === 'function'
      })

      test('Chinese Simplified converter (zhHans) is loaded', () => {
        return typeof window.n2words.zhHans === 'function'
      })

      test('Multiple bundles extend the same global', () => {
        const keys = Object.keys(window.n2words)
        return keys.length === 3 && keys.includes('enUS') && keys.includes('fr') && keys.includes('zhHans')
      })

      test('American English converter returns correct result', () => {
        const result = window.n2words.enUS(42)
        return result === 'forty-two'
      })

      test('French converter returns correct result', () => {
        const result = window.n2words.fr(42)
        return result === 'quarante-deux'
      })

      test('Chinese Simplified converter returns correct result', () => {
        const result = window.n2words.zhHans(42)
        return result === '肆拾贰'
      })

      test('BigInt support works', () => {
        const result = window.n2words.enUS(9007199254740993n)
        return typeof result === 'string' && result.length > 0
      })

      // ========================================================================
      // Render Results
      // ========================================================================

      let output = ''

      for (const t of tests) {
        const symbol = t.passed ? '✓' : '✗'
        const className = t.passed ? 'pass' : 'fail'

        output += `<div class="test-case ${className}">`
        output += `<span class="test-icon">${symbol}</span>`
        output += `<div>`
        output += `<div class="test-description">${t.description}</div>`
        if (!t.passed && t.error) {
          output += `<div class="test-details">Error: ${t.error}</div>`
        }
        output += `</div></div>`
      }

      // Summary
      const totalTests = passCount + failCount
      output += `<div class="summary">`
      output += `<div class="summary-stats">`
      output += `<strong>${totalTests}</strong> tests: `
      output += `<span class="pass"><strong>${passCount}</strong> passed</span>`
      if (failCount > 0) {
        output += `, <span class="fail"><strong>${failCount}</strong> failed</span>`
      }
      output += `</div></div>`

      results.innerHTML = output

      // Update status
      if (failCount === 0) {
        status.textContent = `Complete: All tests passed (${passCount}/${totalTests})`
        status.className = 'pass'
      } else {
        status.textContent = `Complete: ${failCount} test(s) failed (${passCount}/${totalTests} passed)`
        status.className = 'fail'
      }
    }
  </script>
</html>
